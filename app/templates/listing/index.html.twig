{% extends 'base.html.twig' %}

{% block title %}{{ 'title.listing_index'|trans }}{% endblock %}

{% block content %}

    <div class="d-flex flex-column flex-md-row justify-content-between align-content-center">
        <div class="navigation">
            {{ knp_pagination_render(listings) }}
        </div>

        {# category selector #}
        <div class="dropdown d-flex flex-column">
            <button class="btn btn-secondary dropdown-toggle mx-auto" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                {{ 'action.filter_by_category'|trans }}
            </button>
            {% if selectedCategory is defined and selectedCategory %}
                <p class="border border-2 rounded-bottom bg-warning px-3 py-1 mx-auto">{{ selectedCategory.title }}</p>
            {% endif %}

             {% if categories is defined and categories %}
            <ul class="dropdown-menu">
                <li><a class="dropdown-item bg-warning" href="{{ url('listing_index') }}">{{ 'action.clear_category_filter'|trans }}</a></li>
                {% for category in categories %}
                <li><a class="dropdown-item" href="{{ url('listing_index', {categoryId: category.id}) }}">{{ category.title }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

    </div>

{% if listings is defined and listings.items|length %}
    <table class="table m-2">
     <thead>
         <tr>
             <th scope="col">{{ knp_pagination_sortable(listings, 'label.title'|trans, 'listing.title') }}</th>
             <th scope="col">{{ knp_pagination_sortable(listings, 'label.activatedAt'|trans, 'listing.activatedAt') }}</th>
         </tr>
     </thead>

     <tbody>
        {% for listing in listings.items %}
            <tr>
                <td><a href="{{ url('listing_view', {id:listing.id}) }}">{{ listing.title }}</a></td>
                <td><a>{{ listing.activatedAt|date('d.m.Y') }}</a></td>
            </tr>
        {% endfor %}
     </tbody>
    </table>

    <div class="navigation text-center">
        {{ knp_pagination_render(listings) }}
    </div>



{% else %}
    <p>{{ 'message.empty_list'|trans }}</p>
{% endif %}

{% endblock %}